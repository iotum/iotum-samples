{"version":3,"file":"static/js/935.e262e28f.chunk.js","mappings":"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","sources":["webpack://iotum-samples/./src/navigation/MenuButton/MenuButton.module.css?3f77","navigation/MenuButton/MenuButton.js","webpack://iotum-samples/./src/pages/popout-chat/submitForm.module.css?9556","pages/popout-chat/App.js"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"menuButton\":\"MenuButton_menuButton__e9oFw\",\"left\":\"MenuButton_left__d8Tih\",\"right\":\"MenuButton_right__fbjxn\"};","import React from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport styles from './MenuButton.module.css'; \r\n\r\nfunction MenuButton({ position = 'left' }) { // 'left' is default if no position is provided\r\n  const navigate = useNavigate();\r\n  \r\n  const handleClick = () => {\r\n    console.log('Menu Button Clicked, Go To the Menu Page.');\r\n    navigate('/iotum-samples/menu');\r\n  };\r\n\r\n  // Determine the button position class\r\n  const positionClass = position === 'right' ? styles.right : styles.left;\r\n\r\n  return (\r\n    <div>\r\n      <button className={`${styles.menuButton} ${positionClass}`} onClick={handleClick}>\r\n        Menu Page\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default MenuButton;\r\n","// extracted by mini-css-extract-plugin\nexport default {\"chatContainer\":\"submitForm_chatContainer__Xcj9R\",\"badge\":\"submitForm_badge__coYDH\",\"biggerButton\":\"submitForm_biggerButton__hfy-z\"};","import React, { useState, useRef, useCallback, useEffect } from 'react';\nimport styles from './submitForm.module.css';\nimport TokenButton from '../../navigation/TokenButton/TokenButton';\nimport MenuButton from '../../navigation/MenuButton/MenuButton';\nimport * as Callbridge from '@iotum/callbridge-js';\nimport { useSelector } from 'react-redux';\nimport useGuardedRoute from '../../components/hooks/useGuardedRoute';\n\nconst App = () => {\n  useGuardedRoute(); // Guard the route\n  const [unreadMessages, setUnreadMessages] = useState(0);\n  const [isLoading, setIsLoading] = useState(true);\n  const widget = useRef(null);\n\n  const credentials = useSelector(state => state.credentials);\n\n  // Check if all necessary credentials are available\n  const areCredentialsValid = credentials.token && credentials.domain && credentials.hostId;\n\n  const renderChatWidget = useCallback(() => {\n    if (areCredentialsValid) {\n      if (!widget.current || !widget.current.instance) {\n        widget.current = new Callbridge.Dashboard({\n          domain: credentials.domain,\n          sso: {\n            token: credentials.token,\n            hostId: credentials.hostId,\n          },\n          container: window,\n          target: {\n            name: \"CallbridgeChatWidget\",\n            checkExisting: true,\n          }\n        }, 'Team');\n\n        widget.current.on('dashboard.NAVIGATE', (data) => {\n          console.log(\"navigate event\");\n        });\n      } else if (widget.current.instance) {\n        widget.current.instance.focus();\n      }\n    }\n  }, [credentials, areCredentialsValid]);\n\n  useEffect(() => {\n    if (areCredentialsValid) {\n      const hiddenContainer = document.createElement('div');\n      hiddenContainer.style.display = 'none';\n      document.body.appendChild(hiddenContainer);\n\n      const invisibleWidget = new Callbridge.Dashboard({\n        domain: credentials.domain,\n        sso: {\n          token: credentials.token,\n          hostId: credentials.hostId,\n        },\n        container: hiddenContainer,\n        target: {\n          name: \"InvisibleWidget\",\n          checkExisting: true,\n        }\n      }, 'Team');\n\n      invisibleWidget.on('dashboard.UNREAD_MESSAGES', (data) => {\n        const sum = Object.values(data.rooms).reduce((m, n) => m + n, 0);\n        setUnreadMessages(sum);\n        setIsLoading(false);\n      });\n\n      return () => {\n        widget.current?.unload();\n        invisibleWidget?.unload();\n      };\n    }\n  }, [credentials, areCredentialsValid]);\n\n  return (\n    <>\n      <TokenButton position='right' />\n      <MenuButton position=\"right\" />\n      <div className={styles.chatContainer}>\n        {isLoading ? (\n          <div>Loading unread messages...</div>\n        ) : (\n          <>\n            <button className={styles.biggerButton} onClick={renderChatWidget}>\n              Chat\n            </button>\n            <span className={styles.badge}>{unreadMessages}</span>\n          </>\n        )}\n      </div>\n    </>\n  );\n};\n\nexport default App;\n"],"names":["_ref","_ref$position","position","navigate","useNavigate","positionClass","styles","_jsx","children","className","concat","onClick","console","log","useGuardedRoute","_useState","useState","_useState2","_slicedToArray","unreadMessages","setUnreadMessages","_useState3","_useState4","isLoading","setIsLoading","widget","useRef","credentials","useSelector","state","areCredentialsValid","token","domain","hostId","renderChatWidget","useCallback","current","instance","focus","Callbridge","sso","container","window","target","name","checkExisting","on","data","useEffect","hiddenContainer","document","createElement","style","display","body","appendChild","invisibleWidget","sum","Object","values","rooms","reduce","m","n","_widget$current","unload","_jsxs","_Fragment","TokenButton","MenuButton"],"sourceRoot":""}