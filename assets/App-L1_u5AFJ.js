import{u as v,r as l,a as x,j as e,T as b}from"./index-UiNu7bxT.js";import{M as _,b as f}from"./MenuButton-5YESuwXf.js";const M="_form_1tv7w_2",w="_appContainer_1tv7w_55",E="_accessCodeInput_1tv7w_59",k="_startMeetingButton_1tv7w_66",S="_widgetContainer_1tv7w_80",y="_devices_1tv7w_84",a={form:M,appContainer:w,accessCodeInput:E,startMeetingButton:k,widgetContainer:S,devices:y},I=({domain:c,token:p,hostId:r,accessCode:m,muteMic:n,muteCam:C})=>{const o=new f({domain:c,sso:{token:p,hostId:r},container:"#meeting"},m,{skipJoin:!0,mute:{mic:n,camera:C}});return document.querySelector("#start").disabled=!0,o.on("room.READY",()=>{document.querySelector("#start").disabled=!1}),o.on("device.DEVICE_LIST_CHANGED",u=>{["audioinput","audiooutput","videoinput"].forEach(i=>{const s=document.querySelector(`select#${i}`);s.replaceChildren(s.firstChild),u[i].forEach(({label:t,deviceId:d})=>{s.appendChild(Object.assign(document.createElement("option"),{textContent:t,value:d}))})})}),o.on("device.DEVICE_IN_USE",({kind:u,deviceId:i})=>{const s=document.querySelector(`select#${u}`);s.value=i}),o},A=()=>{v();const[c,p]=l.useState(()=>{}),[r,m]=l.useState(()=>{}),n=l.useRef(),C=x(t=>t.credentials),o=({target:t})=>{switch(t.id){case"videoinput":n.current.setVideoInput(t.value);break;case"audioinput":n.current.setAudioInput(t.value);break;case"audiooutput":n.current.setAudioOutput(t.value);break;default:console.error("invalid",t.id);break}},u=()=>{n.current.setMute(!r)},i=()=>{n.current.setCamera(!c)},s=t=>{var h;t.preventDefault();const d=t.target.accessCode.value;if(!d){console.log("Access code not set, widget will not be rendered.");return}(h=n.current)==null||h.unload(),n.current=I({...C,accessCode:d,muteMic:!t.target.joinMic.checked,muteCam:!t.target.joinCam.checked}),n.current.on("participant.CHANGE",({isCameraOn:g,isMuted:j})=>{p(g),m(j)})};return l.useEffect(()=>()=>{var t;(t=n.current)==null||t.unload()},[]),e.jsxs("div",{className:a.appContainer,children:[e.jsxs("form",{className:a.form,onSubmit:s,children:[e.jsxs("label",{children:[e.jsx("span",{children:"Access Code:"}),e.jsx("input",{name:"accessCode",type:"text",required:!0,autoFocus:!0,className:a.accessCodeInput})]}),e.jsxs("label",{title:"join with microphone on",children:[e.jsx("input",{name:"joinMic",type:"checkbox",defaultChecked:!0}),e.jsx("span",{children:"mic"})]}),e.jsxs("label",{title:"join with camera on",children:[e.jsx("input",{name:"joinCam",type:"checkbox",defaultChecked:!0}),e.jsx("span",{children:"cam"})]}),e.jsx("button",{id:"start",type:"submit",className:a.startMeetingButton,children:"Start Meeting"})]}),e.jsx(b,{position:"right"}),e.jsx(_,{position:"right"}),e.jsxs("div",{className:a.devices,children:[e.jsx("select",{id:"audioinput",onChange:o,children:e.jsx("option",{disabled:!0,value:"",children:"audio input ..."})}),e.jsx("select",{id:"audiooutput",onChange:o,children:e.jsx("option",{disabled:!0,value:"",children:"audio output ..."})}),e.jsx("select",{id:"videoinput",onChange:o,children:e.jsx("option",{disabled:!0,value:"",children:"video input ..."})}),r!==void 0&&e.jsxs("button",{id:"toggleMic",type:"button",onClick:u,children:[r?"UNMUTE":"MUTE"," mic"]}),c!==void 0&&e.jsxs("button",{id:"toggleCam",type:"button",onClick:i,children:[c?"STOP":"START"," cam"]})]}),e.jsx("div",{id:"meeting",className:a.widgetContainer})]})};export{A as default};
