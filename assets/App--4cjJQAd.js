import{j as t,T as g,u as v,r as x,a as b}from"./index-OptuiEFi.js";import{s as o,C as N}from"./ChatRoom-f-LtzO__.js";import{M as C,D as L,S,L as k}from"./MenuButton-G5JOkzV9.js";const y=({rooms:c,onRoomButtonClick:l,onRoomClose:a})=>t.jsxs("div",{className:o.container,children:[t.jsx("div",{className:o.roomListContainer,children:c.map(e=>t.jsx("div",{className:o.chatRoomItem,children:t.jsx("button",{onClick:()=>l(e.path),className:e.bool?o.active:"",children:e.name})},e.path))}),t.jsxs("div",{className:o.chatRoomsContainer,children:[c.map(e=>e.bool&&t.jsxs("div",{className:`${o.chatRoom} ${o.activeRoom}`,children:[t.jsx(N,{path:e.path}),t.jsx("button",{className:o.closeButton,onClick:()=>a(e.path),children:"x"})]},e.path)),t.jsx(g,{position:"right"}),t.jsx(C,{position:"right"})]})]}),A=()=>{v();const[c,l]=x.useState([]),a=b(s=>s.credentials),e=(s,d)=>{l(u=>u.map(n=>n.path===s?{...n,bool:d}:n))},j=({domain:s,token:d,hostId:u})=>{const n=new L({domain:s,sso:{token:d,hostId:u},container:"#chat"},S.Team,{layout:k.list,pathname:"/"});return n.once("dashboard.ROOM_LIST",f=>{var p;const h=[],R=Object.values(f.rooms).map(m=>{const r=m.accounts.map(i=>i.name);if(r.length===1){const i=`${r[0]} (you)`;return h.push(r[0]),{name:i,path:m.path,bool:!1}}return{name:r.filter(i=>!h.includes(i)).join(", "),path:m.path,bool:!1}});l(R),(p=document.querySelector("#loading"))==null||p.remove()}),n};return x.useEffect(()=>{if(a&&a.token&&a.domain&&a.hostId){const s=j(a);return setTimeout(()=>s.toggle(!1)),()=>{s.unload()}}},[a]),t.jsxs("div",{children:[t.jsx("div",{id:"room-buttons",children:t.jsx(y,{rooms:c,onRoomButtonClick:s=>e(s,!0),onRoomClose:s=>e(s,!1)})}),t.jsx("div",{id:"chat",children:t.jsx("div",{id:"loading",children:"Loading..."})})]})};export{A as default};
