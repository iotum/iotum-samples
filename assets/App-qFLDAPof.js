import{j as o,T as b,u as w,r as p,a as v}from"./index-G96g-jsI.js";import{s as h,C as N}from"./ChatRoom-LLh7RL-f.js";import{M as L,d as l}from"./MenuButton-sq7vA6Ar.js";const T=({rooms:u,onRoomClose:a})=>o.jsxs("div",{className:h.chatRoomsContainer,children:[u.map(t=>t.bool&&o.jsxs("div",{className:`${h.chatRoom} ${h.activeRoom}`,children:[o.jsx(N,{path:t.path}),o.jsx("button",{className:h.closeButton,onClick:()=>a(t.path),children:"x"})]},t.path)),o.jsx(b,{position:"right"}),o.jsx(L,{position:"right"})]}),_="_container_1w0rt_3",y="_roomListContainer_1w0rt_8",x={container:_,roomListContainer:y},S=()=>{w();const[u,a]=p.useState([]),t=v(e=>e.credentials),R=e=>{a(n=>n.map(s=>s.path===e?{...s,bool:!0}:s))},j=e=>{console.log(e+" was closed"),a(n=>n.map(s=>s.path===e?{...s,bool:!1}:s))},g=p.useCallback(({domain:e,token:n,hostId:s})=>{console.log("renderWidget ran");const i=new l.Dashboard({domain:e,sso:{token:n,hostId:s},container:"#chat"},l.Service.Team,{layout:l.LayoutOption.list,pathname:"/"});return i.once("dashboard.ROOM_LIST",r=>{const f=[],C=Object.values(r.rooms).map(m=>{const d=m.accounts.map(c=>c.name);if(d.length===1){const c=`${d[0]} (you)`;return f.push(d[0]),{name:c,path:m.path,bool:!1}}return{name:d.filter(c=>!f.includes(c)).join(", "),path:m.path,bool:!1}});a(C)}),i.on("dashboard.NAVIGATE",r=>{r.pathname!=="/"&&(i.load(l.Service.Team,{layout:l.LayoutOption.list}),console.log("There was a navigate event to "+r.pathname+" in the list widget and the list widget was reloaded")),R(r.pathname)}),i.on("dashboard.READY",()=>{console.log("The list widget was rendered")}),i},[]);return p.useEffect(()=>{if(t&&t.token&&t.domain&&t.hostId){const e=g(t);return()=>{e.unload()}}},[t,g]),o.jsxs("div",{className:x.container,children:[o.jsx("div",{id:"chat",className:x.roomListContainer}),o.jsx("div",{children:o.jsx(T,{rooms:u,onRoomClose:j})})]})};export{S as default};
